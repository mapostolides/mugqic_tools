#!/bin/bash
#PBS -N FusionInspector
#PBS -l nodes=1:ppn=4
#PBS -l mem=60g
#PBS -l vmem=60g
#PBS -l walltime=24:00:00
#PBS -o /hpf/largeprojects/ccmbio/mapostolides/validate_fusion/test_star_star-fusion/FusionInspector-run/outdirDec7smc_rna_sim45-DEFAULT_PARAMS-merged_by_breakpoints-two-or-more
#PBS -e /hpf/largeprojects/ccmbio/mapostolides/validate_fusion/test_star_star-fusion/FusionInspector-run/outdirDec7smc_rna_sim45-DEFAULT_PARAMS-merged_by_breakpoints-two-or-more 


module load samtools
#module load trinityrnaseq
module load python/2.7.11
module load gcc/5.2.0
module load perl/5.28.0_mikeapos

export PATH=$PATH:/hpf/largeprojects/ccmbio/mapostolides/validate_fusion/test_star_star-fusion/FusionInspector-run/FusionInspector # FusionInspector
export PATH=$PATH:/hpf/largeprojects/ccmbio/mapostolides/MODULES/bin #gmap-2018-07-04, htslib-1.3 (for GMAP and bgzip dependencies, respectively)
export PATH=$PATH:/hpf/largeprojects/ccmbio/mapostolides/validate_fusion/test_star_star-fusion/FusionInspector-run/dependencies/trinityrnaseq-Trinity-v2.8.4
export PATH="/hpf/largeprojects/ccmbio/mapostolides/validate_fusion/test_star_star-fusion/STAR/STAR-2.6.1c/source:$PATH"

ctat_lib_dir=/hpf/largeprojects/ccmbio/mapostolides/validate_fusion/test_star_star-fusion/GRCh37_v19_CTAT_lib_Feb092018.plug-n-play/ctat_genome_lib_build_dir
left_fastq=/hpf/largeprojects/ccmbio/mapostolides/validate_fusion/montreal_benchmark_validation/smc_rna_sim45/smc_rna_sim45.pair1.fastq.gz
right_fastq=/hpf/largeprojects/ccmbio/mapostolides/validate_fusion/montreal_benchmark_validation/smc_rna_sim45/smc_rna_sim45.pair2.fastq.gz
#top_dir=/hpf/largeprojects/ccmbio/mapostolides/validate_fusion/test_star_star-fusion/FusionInspector-run

#FusionInspector --fusions fusions.listA.txt,fusions.listB.txt \
FusionInspector --fusions $top_dir/fusion_list_files/smc_rna_sim45-DEFAULT_PARAMS_fusion_list-merged-by-breakpoints_two-or-more.txt \
                --genome_lib $ctat_lib_dir \
                --left_fq $left_fastq --right_fq $right_fastq \
                --out_dir $top_dir/outdirDec7smc_rna_sim45-DEFAULT_PARAMS-merged_by_breakpoints-two-or-more  \
                --out_prefix finspector \
                --prep_for_IGV
